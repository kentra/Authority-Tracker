:root {
    --bg-color: #0d0f1a;
    --text-color: #e0e5ff;
    --accent-color: #00ffea;

    /* Faction Colors */
    --p1-color: #0088ff;
    /* Trade Federation Blue */
    --p2-color: #11ff00;
    /* Blob Green */
    --p3-color: #ffcc00;
    /* Star Empire Yellow */
    --p4-color: #ff3300;
    /* Machine Cult Red */

    --btn-bg: rgba(255, 255, 255, 0.1);
    --btn-hover: rgba(255, 255, 255, 0.2);
    --btn-active: rgba(255, 255, 255, 0.3);
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    -webkit-tap-highlight-color: transparent;
    user-select: none;
}

body,
html {
    width: 100%;
    height: 100%;
    overflow: hidden;
    /* Prevent scrolling */
    background-color: #090a0f;
    background-image: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
    font-family: 'Orbitron', sans-serif;
    color: var(--text-color);
}

/* --- Starfield Background (CSS pure) --- */
@function multiple-box-shadow ($n) {
    $value: '#{random(2000)}px #{random(2000)}px #FFF';

    @for $i from 2 through $n {
        $value: '#{$value}, #{random(2000)}px #{random(2000)}px #FFF';
    }

    @return unquote($value);
}

/* Approximating stars without SCSS for raw CSS, generating simple stars */
#stars,
#stars2,
#stars3 {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    z-index: 0;
    pointer-events: none;
    background-image:
        radial-gradient(1px 1px at 20px 30px, #eee, rgba(0, 0, 0, 0)),
        radial-gradient(1px 1px at 40px 70px, #fff, rgba(0, 0, 0, 0)),
        radial-gradient(1px 1px at 50px 160px, #ddd, rgba(0, 0, 0, 0)),
        radial-gradient(1px 1px at 90px 40px, #fff, rgba(0, 0, 0, 0)),
        radial-gradient(1px 1px at 130px 80px, #fff, rgba(0, 0, 0, 0)),
        radial-gradient(1.5px 1.5px at 160px 120px, #ddd, rgba(0, 0, 0, 0));
    background-repeat: repeat;
    background-size: 200px 200px;
    opacity: 0.5;
    animation: zoom 20s infinite alternate;
}

#stars2 {
    background-size: 300px 300px;
    opacity: 0.3;
    animation-duration: 30s;
}

@keyframes zoom {
    0% {
        transform: scale(1);
    }

    100% {
        transform: scale(1.1);
    }
}

/* --- Layout Structure --- */
#app {
    position: relative;
    z-index: 1;
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
    padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
}

.screen {
    display: none;
    width: 100%;
    height: 100%;
    flex-direction: column;
}

.screen.active {
    display: flex;
}

/* --- Setup Screen --- */
#setup-screen {
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 20px;
}

h1 {
    font-size: 2.5rem;
    font-weight: 900;
    letter-spacing: 2px;
    margin-bottom: 2rem;
    text-shadow: 0 0 10px rgba(0, 255, 234, 0.5);
    line-height: 1.2;
}

h1 span {
    color: var(--accent-color);
}

.setup-controls {
    display: flex;
    flex-direction: column;
    gap: 15px;
    width: 100%;
    max-width: 300px;
}

label {
    font-size: 1.2rem;
    margin-top: 10px;
}

.player-count-btns {
    display: flex;
    justify-content: space-between;
    gap: 10px;
}

.player-btn {
    flex: 1;
    padding: 15px;
    font-size: 1.5rem;
    background: var(--btn-bg);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: white;
    border-radius: 8px;
    font-family: inherit;
    cursor: pointer;
    transition: all 0.2s;
}

.player-btn.active {
    background: var(--accent-color);
    color: #000;
    border-color: var(--accent-color);
    box-shadow: 0 0 15px var(--accent-color);
}

input[type="number"] {
    width: 100%;
    padding: 15px;
    font-size: 2rem;
    text-align: center;
    background: rgba(0, 0, 0, 0.5);
    border: 2px solid var(--accent-color);
    color: white;
    border-radius: 8px;
    font-family: inherit;
    outline: none;
}

.primary-btn {
    margin-top: 20px;
    padding: 15px;
    font-size: 1.5rem;
    font-weight: bold;
    background: var(--accent-color);
    color: #000;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    text-transform: uppercase;
    box-shadow: 0 0 20px rgba(0, 255, 234, 0.4);
}

.primary-btn:active {
    transform: scale(0.98);
}

/* --- Game Screen (Trackers) --- */
#game-screen {
    position: relative;
}

#tracker-container {
    display: flex;
    width: 100%;
    height: 100%;
}

/* Layouts for 1, 2, 3, 4 players */
#tracker-container.players-1 .tracker-widget {
    flex: 1;
}

#tracker-container.players-2 {
    flex-direction: column;
}

#tracker-container.players-2 .tracker-widget {
    flex: 1;
}

#tracker-container.players-3,
#tracker-container.players-4 {
    flex-direction: row;
    flex-wrap: wrap;
}

#tracker-container.players-3 .tracker-widget {
    width: 50%;
    height: 50%;
}

#tracker-container.players-3 .tracker-widget:last-child {
    width: 100%;
    /* Make the 3rd player take full bottom width */
}

#tracker-container.players-4 .tracker-widget {
    width: 50%;
    height: 50%;
}

/* Individual Tracker Widget */
.tracker-widget {
    position: relative;
    padding: 0;
    border: 1px solid rgba(255, 255, 255, 0.1);
    background: rgba(0, 0, 0, 0.4);
    overflow: hidden;
}

.inner-widget {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 10px;
    transition: transform 0.3s ease, width 0.3s ease, height 0.3s ease;
}

/* Faction Overlays */
.tracker-widget::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    opacity: 0.15;
    z-index: -1;
}

.tracker-widget[data-player="1"]::before {
    background: radial-gradient(circle, var(--p1-color) 0%, transparent 70%);
}

.tracker-widget[data-player="2"]::before {
    background: radial-gradient(circle, var(--p2-color) 0%, transparent 70%);
}

.tracker-widget[data-player="3"]::before {
    background: radial-gradient(circle, var(--p3-color) 0%, transparent 70%);
}

.tracker-widget[data-player="4"]::before {
    background: radial-gradient(circle, var(--p4-color) 0%, transparent 70%);
}

.tracker-widget[data-player="1"] .auth-value {
    color: var(--p1-color);
    text-shadow: 0 0 10px var(--p1-color);
}

.tracker-widget[data-player="2"] .auth-value {
    color: var(--p2-color);
    text-shadow: 0 0 10px var(--p2-color);
}

.tracker-widget[data-player="3"] .auth-value {
    color: var(--p3-color);
    text-shadow: 0 0 10px var(--p3-color);
}

.tracker-widget[data-player="4"] .auth-value {
    color: var(--p4-color);
    text-shadow: 0 0 10px var(--p4-color);
}

.player-name {
    font-size: 1.5rem;
    font-weight: bold;
    letter-spacing: 2px;
    opacity: 0.8;
    text-transform: uppercase;
    margin-top: 10px;
}

.tracker-widget[data-player="1"] .player-name {
    color: var(--p1-color);
}

.tracker-widget[data-player="2"] .player-name {
    color: var(--p2-color);
}

.tracker-widget[data-player="3"] .player-name {
    color: var(--p3-color);
}

.tracker-widget[data-player="4"] .player-name {
    color: var(--p4-color);
}

/* Value Display */
.auth-display {
    text-align: center;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    width: 100%;
}

.auth-value {
    font-size: 5rem;
    font-weight: 900;
    line-height: 1;
    transition: transform 0.1s;
}

.auth-value.pop {
    transform: scale(1.1);
}

.auth-history {
    font-size: 1.2rem;
    color: #aaa;
    min-height: 1.5rem;
    margin-top: 5px;
    opacity: 0;
    transition: opacity 0.3s;
}

.auth-history.visible {
    opacity: 1;
}

.auth-history.positive {
    color: #0f0;
}

.auth-history.negative {
    color: #f00;
}

/* Control Buttons */
.controls-row {
    display: flex;
    justify-content: center;
    gap: 10px;
    width: 100%;
    margin-top: 10px;
}

.adj-btn {
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: white;
    font-size: 1.5rem;
    font-weight: bold;
    padding: 15px 0;
    flex: 1;
    border-radius: 8px;
    cursor: pointer;
    font-family: inherit;
    max-width: 80px;
}

.adj-btn:active {
    background: rgba(255, 255, 255, 0.3);
}

.adj-btn.minus {
    color: #ff4444;
}

.adj-btn.plus {
    color: #44ff44;
}

/* Menu Button */
#menu-btn {
    position: absolute;
    bottom: 70px;
    right: 30px;
    width: 50px;
    height: 50px;
    border-radius: 25px;
    background: var(--accent-color);
    color: #000;
    border: none;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 10;
    box-shadow: 0 0 15px rgba(0, 255, 234, 0.5);
    cursor: pointer;
}

#menu-btn svg {
    width: 30px;
    height: 30px;
}

/* Center Menu Button for 2 players (rotational axis) */
#tracker-container.players-2~#menu-btn {
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    bottom: auto;
    right: auto;
    width: 60px;
    height: 60px;
    border-radius: 30px;
    background: rgba(0, 0, 0, 0.8);
    border: 2px solid var(--accent-color);
    color: var(--accent-color);
}

/* Menu Overlay */
.overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.85);
    z-index: 100;
    display: flex;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(5px);
}

.overlay.hidden {
    display: none;
}

.menu-content {
    background: #111;
    padding: 30px;
    border: 2px solid var(--accent-color);
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    gap: 15px;
    min-width: 250px;
    text-align: center;
    box-shadow: 0 0 30px rgba(0, 255, 234, 0.2);
}

.menu-content.hidden {
    display: none;
}

.names-inputs-container {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 5px;
}

.name-input {
    width: 100%;
    padding: 10px;
    font-size: 1.2rem;
    text-align: center;
    background: rgba(0, 0, 0, 0.5);
    border: 1px solid var(--accent-color);
    color: white;
    border-radius: 6px;
    font-family: inherit;
    outline: none;
}

.data-container {
    max-height: 50vh;
    overflow-y: auto;
    text-align: left;
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.data-card {
    background: rgba(0, 0, 0, 0.5);
    border: 1px solid rgba(255, 255, 255, 0.2);
    padding: 10px;
    border-radius: 6px;
    font-size: 0.9rem;
    color: #ccc;
}

.data-card strong {
    color: white;
    display: block;
    margin-bottom: 5px;
    font-size: 1rem;
}

.data-card .winner {
    color: var(--accent-color);
    font-weight: bold;
}

.menu-content h2 {
    margin-bottom: 10px;
    color: var(--accent-color);
    letter-spacing: 2px;
}

.menu-btn {
    padding: 15px;
    font-size: 1.2rem;
    font-family: inherit;
    background: var(--accent-color);
    color: #000;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
    text-transform: uppercase;
}

.menu-btn.secondary {
    background: transparent;
    color: white;
    border: 1px solid rgba(255, 255, 255, 0.3);
}

/* Adjustments for smaller screens */
@media (max-width: 400px) {
    .auth-value {
        font-size: 4rem;
    }

    .adj-btn {
        padding: 10px 0;
        font-size: 1.2rem;
    }
}

@media (max-height: 600px) {
    .auth-value {
        font-size: 3.5rem;
    }

    .controls-row {
        margin-top: 5px;
    }

    .adj-btn {
        padding: 8px 0;
    }
}